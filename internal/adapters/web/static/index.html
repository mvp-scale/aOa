<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>aOa Dashboard</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
</head>
<body>

<!-- ══════ NAV ══════ -->
<nav class="nav">
  <div class="nav-left">
    <span class="nav-brand">
      <span class="angle">&ang;</span>
      <span class="name">aOa</span>
    </span>
    <div class="nav-tabs">
      <button class="nav-tab active" data-tab="live">Live</button>
      <button class="nav-tab" data-tab="recon">Recon</button>
      <button class="nav-tab" data-tab="intel">Intel</button>
      <button class="nav-tab" data-tab="debrief">Debrief</button>
      <button class="nav-tab" data-tab="arsenal">Arsenal</button>
    </div>
  </div>
  <div class="nav-right">
    <div class="status-badge offline" id="statusBadge">
      <span class="dot"></span>
      <span id="statusText">...</span>
    </div>
    <button class="theme-toggle" id="themeToggle" title="Toggle theme">
      <span id="themeIcon"></span>
    </button>
  </div>
</nav>

<!-- ══════ MAIN ══════ -->
<div class="main">

  <!-- ════════════════════════════════════════════════════
       LIVE TAB
       ════════════════════════════════════════════════════ -->
  <div class="tab-content active" id="tab-live">
    <div class="hero-row">
      <div class="hero-card-wrapper">
        <div class="hero-card">
          <div class="hero-label">ANGLE OF ATTACK</div>
          <div class="hero-headline" id="heroHeadline-live"></div>
          <div class="hero-support" id="heroSupport-live">-</div>
        </div>
      </div>
      <div class="hero-metrics">
        <div class="hm-cell"><div class="hm-value green" id="hm-live-0">-</div><div class="hm-label">time saved</div></div>
        <div class="hm-arrow">&rarr;</div>
        <div class="hm-cell right"><div class="hm-value green" id="hm-live-1">-</div><div class="hm-label">tokens saved</div></div>
        <div class="hm-cell"><div class="hm-value cyan" id="hm-live-2">-</div><div class="hm-label">guided</div></div>
        <div class="hm-arrow">&rarr;</div>
        <div class="hm-cell right"><div class="hm-value blue" id="hm-live-3">-</div><div class="hm-label">extended</div></div>
      </div>
    </div>

    <div class="stats-grid">
      <div class="stat-card cyan"><div class="stat-value" id="ls-guided">-</div><div class="stat-label">Guided Ratio</div><div class="stat-sub">of reads guided</div></div>
      <div class="stat-card green"><div class="stat-value" id="ls-savings">-</div><div class="stat-label">Avg Savings</div><div class="stat-sub">per guided read</div></div>
      <div class="stat-card blue"><div class="stat-value" id="ls-searches">-</div><div class="stat-label">Searches</div><div class="stat-sub">indexed queries</div></div>
      <div class="stat-card purple"><div class="stat-value" id="ls-files">-</div><div class="stat-label">Files Indexed</div><div class="stat-sub">symbols tracked</div></div>
      <div class="stat-card yellow"><div class="stat-value" id="ls-autotune">-</div><div class="stat-label">Autotune</div><div class="stat-sub">next cycle</div></div>
      <div class="stat-card red"><div class="stat-value" id="ls-burn">-</div><div class="stat-label">Context Burn</div><div class="stat-sub">token burn rate</div></div>
    </div>

    <div class="card activity-card">
      <div class="card-header">
        <span class="card-title">Activity &amp; Impact</span>
        <span class="card-badge" id="activityCount">0</span>
      </div>
      <div class="activity-table-wrap">
        <table class="activity-table">
          <thead><tr>
            <th class="col-time">Time</th>
            <th class="col-action">Action</th>
            <th class="col-source">Source</th>
            <th class="col-attrib">Attrib</th>
            <th class="col-impact">Impact</th>
            <th class="col-target">Target</th>
          </tr></thead>
          <tbody id="activityTbody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- ════════════════════════════════════════════════════
       RECON TAB (Stub)
       ════════════════════════════════════════════════════ -->
  <div class="tab-content" id="tab-recon">
    <div class="hero-row">
      <div class="hero-card-wrapper">
        <div class="hero-card">
          <div class="hero-label">RECON</div>
          <div class="hero-headline" id="heroHeadline-recon"></div>
          <div class="hero-support" id="heroSupport-recon">Dimensional analysis across security, quality, complexity, and architecture</div>
        </div>
      </div>
      <div class="hero-metrics">
        <div class="hm-cell"><div class="hm-value purple" id="hm-recon-0">-</div><div class="hm-label">dimensions</div></div>
        <div class="hm-arrow">&rarr;</div>
        <div class="hm-cell right"><div class="hm-value yellow" id="hm-recon-1">-</div><div class="hm-label">risk score</div></div>
        <div class="hm-cell"><div class="hm-value cyan" id="hm-recon-2">-</div><div class="hm-label">coverage</div></div>
        <div class="hm-arrow">&rarr;</div>
        <div class="hm-cell right"><div class="hm-value red" id="hm-recon-3">-</div><div class="hm-label">findings</div></div>
      </div>
    </div>

    <div class="stats-grid">
      <div class="stat-card purple"><div class="stat-value">-</div><div class="stat-label">Dimensions</div><div class="stat-sub">analysis axes</div></div>
      <div class="stat-card yellow"><div class="stat-value">-</div><div class="stat-label">Risk Score</div><div class="stat-sub">composite</div></div>
      <div class="stat-card cyan"><div class="stat-value">-</div><div class="stat-label">Coverage</div><div class="stat-sub">files scanned</div></div>
      <div class="stat-card red"><div class="stat-value">-</div><div class="stat-label">Findings</div><div class="stat-sub">issues detected</div></div>
    </div>

    <div class="recon-placeholder">
      <div class="recon-placeholder-card">
        <div class="recon-placeholder-icon">&#x1F50D;</div>
        <div class="recon-placeholder-title">Dimensional Scanning</div>
        <div class="recon-placeholder-text">
          Available in a future release.<br>
          Recon will provide multi-dimensional code analysis across
          security, quality, complexity, and architecture.
        </div>
      </div>
    </div>
  </div>

  <!-- ════════════════════════════════════════════════════
       INTEL TAB
       ════════════════════════════════════════════════════ -->
  <div class="tab-content" id="tab-intel">
    <div class="hero-row">
      <div class="hero-card-wrapper">
        <div class="hero-card">
          <div class="hero-label">INTEL</div>
          <div class="hero-headline" id="heroHeadline-intel"></div>
          <div class="hero-support" id="heroSupport-intel">-</div>
        </div>
      </div>
      <div class="hero-metrics">
        <div class="hm-cell"><div class="hm-value purple" id="hm-intel-0">-</div><div class="hm-label">domains</div></div>
        <div class="hm-arrow">&rarr;</div>
        <div class="hm-cell right"><div class="hm-value green" id="hm-intel-1">-</div><div class="hm-label">core</div></div>
        <div class="hm-cell"><div class="hm-value cyan" id="hm-intel-2">-</div><div class="hm-label">terms matched</div></div>
        <div class="hm-arrow">&rarr;</div>
        <div class="hm-cell right"><div class="hm-value yellow" id="hm-intel-3">-</div><div class="hm-label">bigrams</div></div>
      </div>
    </div>

    <div class="stats-grid">
      <div class="stat-card purple"><div class="stat-value" id="is-domains">-</div><div class="stat-label">Domains</div><div class="stat-sub">semantic domains</div></div>
      <div class="stat-card green"><div class="stat-value" id="is-core">-</div><div class="stat-label">Core</div><div class="stat-sub">top ranked</div></div>
      <div class="stat-card cyan"><div class="stat-value" id="is-terms">-</div><div class="stat-label">Terms</div><div class="stat-sub">atlas terms matched</div></div>
      <div class="stat-card blue"><div class="stat-value" id="is-keywords">-</div><div class="stat-label">Keywords</div><div class="stat-sub">unique keywords</div></div>
      <div class="stat-card yellow"><div class="stat-value" id="is-bigrams">-</div><div class="stat-label">Bigrams</div><div class="stat-sub">conversation patterns</div></div>
      <div class="stat-card red"><div class="stat-value" id="is-totalhits">-</div><div class="stat-label">Total Hits</div><div class="stat-sub">learning signals</div></div>
    </div>

    <div class="learning-grid">
      <div class="card">
        <div class="card-header">
          <div><span class="card-title">Domain Rankings</span><span style="font-weight:400;color:var(--dim);font-size:12px"> &mdash; sorted by learning signal strength</span></div>
          <span class="card-badge" id="domainCount">0</span>
        </div>
        <div class="domain-table-wrap">
          <table class="domain-table">
            <thead><tr><th>#</th><th>Domain</th><th style="text-align:right">Hits</th><th>Terms</th></tr></thead>
            <tbody id="domainTbody"></tbody>
          </table>
        </div>
        <div class="domain-footer"><span class="aoa-brand">aOa</span> learns your workflow &rarr; Claude reads only what it needs.</div>
      </div>

      <div class="card">
        <div class="card-header">
          <div><span class="card-title">N-gram Metrics</span></div>
          <span class="card-badge" id="ngramCount">0</span>
        </div>
        <div class="ngram-wrap">
          <div class="ngram-section">
            <div class="ngram-section-title">Bigrams <span class="text-cyan">&bull;</span></div>
            <div id="ngramBigrams"></div>
          </div>
          <div class="ngram-section">
            <div class="ngram-section-title">Cohits KW &rarr; Term <span class="text-green">&bull;</span></div>
            <div id="ngramCohitKw"></div>
          </div>
          <div class="ngram-section">
            <div class="ngram-section-title">Cohits Term &rarr; Domain <span class="text-purple">&bull;</span></div>
            <div id="ngramCohitTd"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ════════════════════════════════════════════════════
       DEBRIEF TAB
       ════════════════════════════════════════════════════ -->
  <div class="tab-content" id="tab-debrief">
    <div class="hero-row">
      <div class="hero-card-wrapper">
        <div class="hero-card">
          <div class="hero-label">DEBRIEF</div>
          <div class="hero-headline" id="heroHeadline-debrief"></div>
          <div class="hero-support" id="heroSupport-debrief">-</div>
        </div>
      </div>
      <div class="hero-metrics">
        <div class="hm-cell"><div class="hm-value cyan" id="hm-debrief-0">-</div><div class="hm-label">input tokens</div></div>
        <div class="hm-arrow">&rarr;</div>
        <div class="hm-cell right"><div class="hm-value green" id="hm-debrief-1">-</div><div class="hm-label">output tokens</div></div>
        <div class="hm-cell"><div class="hm-value blue" id="hm-debrief-2">-</div><div class="hm-label">cache reused</div></div>
        <div class="hm-arrow">&rarr;</div>
        <div class="hm-cell right"><div class="hm-value purple" id="hm-debrief-3">-</div><div class="hm-label">tokens saved</div></div>
      </div>
    </div>

    <div class="stats-grid" style="grid-template-columns:repeat(5,1fr)">
      <div class="stat-card cyan"><div class="stat-value" id="ds-input">-</div><div class="stat-label">Input Tokens</div><div class="stat-sub">prompt tokens</div></div>
      <div class="stat-card green"><div class="stat-value" id="ds-output">-</div><div class="stat-label">Output Tokens</div><div class="stat-sub">response tokens</div></div>
      <div class="stat-card blue"><div class="stat-value" id="ds-cread">-</div><div class="stat-label">Cache Read</div><div class="stat-sub">tokens reused</div></div>
      <div class="stat-card purple"><div class="stat-value" id="ds-cwrite">-</div><div class="stat-label">Cache Write</div><div class="stat-sub">tokens cached</div></div>
      <div class="stat-card yellow"><div class="stat-value" id="ds-hitrate">-</div><div class="stat-label">Cache Hit %</div><div class="stat-sub">reuse rate</div></div>
    </div>

    <div class="conv-grid">
      <div class="card conv-col">
        <div class="card-header">
          <span class="card-title">Conversation Feed</span>
          <span class="card-badge" id="convCount">0</span>
        </div>
        <div class="conv-messages" id="convMessages"></div>
        <button id="nowBtnMsg" class="now-btn" onclick="scrollToNow('convMessages')" style="display:none">Now ↓</button>
      </div>
      <div class="card conv-col">
        <div class="card-header">
          <span class="card-title">Actions</span>
        </div>
        <div class="conv-actions" id="convActions"></div>
        <button id="nowBtnAct" class="now-btn" onclick="scrollToNow('convActions')" style="display:none">Now ↓</button>
      </div>
    </div>
  </div>

  <!-- ════════════════════════════════════════════════════
       ARSENAL TAB
       ════════════════════════════════════════════════════ -->
  <div class="tab-content" id="tab-arsenal">
    <div class="hero-row">
      <div class="hero-card-wrapper">
        <div class="hero-card">
          <div class="hero-label">ARSENAL</div>
          <div class="hero-headline" id="heroHeadline-arsenal"></div>
          <div class="hero-support" id="heroSupport-arsenal">-</div>
        </div>
      </div>
      <div class="hero-metrics">
        <div class="hm-cell"><div class="hm-value green" id="hm-arsenal-0">-</div><div class="hm-label">tokens saved</div></div>
        <div class="hm-arrow">&rarr;</div>
        <div class="hm-cell right"><div class="hm-value blue" id="hm-arsenal-1">-</div><div class="hm-label">sessions extended</div></div>
        <div class="hm-cell"><div class="hm-value red" id="hm-arsenal-2">-</div><div class="hm-label">unguided cost</div></div>
        <div class="hm-arrow">&rarr;</div>
        <div class="hm-cell right"><div class="hm-value cyan" id="hm-arsenal-3">-</div><div class="hm-label">guided ratio</div></div>
      </div>
    </div>

    <div class="stats-grid">
      <div class="stat-card green"><div class="stat-value" id="as-saved">-</div><div class="stat-label">Tokens Saved</div><div class="stat-sub">cumulative</div></div>
      <div class="stat-card red"><div class="stat-value" id="as-cost">-</div><div class="stat-label">Unguided Cost</div><div class="stat-sub">waste tokens</div></div>
      <div class="stat-card blue"><div class="stat-value" id="as-sessions">-</div><div class="stat-label">Sessions</div><div class="stat-sub">tracked</div></div>
      <div class="stat-card purple"><div class="stat-value" id="as-extended">-</div><div class="stat-label">Sessions Extended</div><div class="stat-sub">delta minutes</div></div>
      <div class="stat-card cyan"><div class="stat-value" id="as-ratio">-</div><div class="stat-label">Guided Ratio</div><div class="stat-sub">overall</div></div>
      <div class="stat-card yellow"><div class="stat-value" id="as-velocity">-</div><div class="stat-label">Read Velocity</div><div class="stat-sub">reads per prompt</div></div>
    </div>

    <!-- Savings Chart -->
    <div class="card">
      <div class="card-header">
        <span class="card-title">Daily Savings</span>
        <span class="card-badge" id="savingsLabel">-</span>
      </div>
      <div class="chart-area" id="savingsChartArea"></div>
      <div class="chart-legend">
        <span><span class="chart-legend-dot green"></span>Actual</span>
        <span><span class="chart-legend-dot red"></span>Counterfactual (without aOa)</span>
      </div>
    </div>

    <!-- Bottom split: Session table + Learning curve + System status -->
    <div class="arsenal-bottom">
      <div class="card">
        <div class="card-header">
          <span class="card-title">Session History</span>
          <span class="card-badge" id="sessionCount">0</span>
        </div>
        <div class="domain-table-wrap">
          <table class="session-table">
            <thead><tr>
              <th>ID</th><th>Date</th><th>Dur</th><th>P</th><th>R</th><th>Guided</th><th>Saved</th><th>Time</th><th>Waste</th><th>R/P</th>
            </tr></thead>
            <tbody id="sessionTbody"></tbody>
          </table>
        </div>
      </div>
      <div style="display:flex;flex-direction:column;gap:16px;min-height:0">
        <div class="card" style="flex:0 0 auto">
          <div class="card-header">
            <span class="card-title">Learning Curve</span>
          </div>
          <div class="curve-canvas-wrap">
            <canvas id="learningCurveCanvas" height="120"></canvas>
          </div>
        </div>
        <div class="card" style="flex:0 0 auto">
          <div class="card-header">
            <span class="card-title">System Status</span>
          </div>
          <div class="sys-strip">
            <div class="sys-pair"><span class="sys-key">PID</span><span class="sys-val" id="sys-pid">-</span></div>
            <div class="sys-pair"><span class="sys-key">Uptime</span><span class="sys-val" id="sys-uptime">-</span></div>
            <div class="sys-pair"><span class="sys-key">DB</span><span class="sys-val" id="sys-db">-</span></div>
            <div class="sys-pair"><span class="sys-key">Files</span><span class="sys-val" id="sys-files">-</span></div>
            <div class="sys-pair"><span class="sys-key">Tokens</span><span class="sys-val" id="sys-tokens">-</span></div>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>

<!-- ══════ FOOTER ══════ -->
<footer class="footer">
  <div class="footer-left">
    <span class="footer-online"><span class="dot"></span> <span id="footerStatus">Online</span></span>
    <span>v1.0.0</span>
  </div>
  <div class="footer-right">
    <span class="footer-motto"><span class="aoa-brand">aOa</span> learns &rarr; you build faster. <span class="way">This is the way.</span></span>
    <span class="footer-clock" id="clock">00:00:00</span>
  </div>
</footer>

<script src="app.js"></script>
</body>
</html>
