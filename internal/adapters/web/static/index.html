<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>aOa Dashboard</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
</head>
<body>

<!-- ══════ NAV ══════ -->
<nav class="nav">
  <div class="nav-left">
    <span class="nav-brand">
      <span class="angle">&ang;</span>
      <span class="name">aOa</span>
    </span>
    <div class="nav-tabs">
      <button class="nav-tab active" data-tab="live">Live</button>
      <button class="nav-tab" data-tab="recon">Recon</button>
      <button class="nav-tab" data-tab="intel">Intel</button>
      <button class="nav-tab" data-tab="debrief">Debrief</button>
      <button class="nav-tab" data-tab="arsenal">Arsenal</button>
    </div>
  </div>
  <div class="nav-right">
    <div class="status-badge offline" id="statusBadge">
      <span class="dot"></span>
      <span id="statusText">...</span>
    </div>
    <button class="theme-toggle" id="themeToggle" title="Toggle theme">
      <span id="themeIcon"></span>
    </button>
  </div>
</nav>

<!-- ══════ MAIN ══════ -->
<div class="main">

  <!-- ════════════════════════════════════════════════════
       LIVE TAB
       ════════════════════════════════════════════════════ -->
  <div class="tab-content active" id="tab-live">
    <div class="hero-row">
      <div class="hero-card-wrapper">
        <div class="hero-card">
          <div class="hero-label">ANGLE OF ATTACK</div>
          <div class="hero-headline" id="heroHeadline-live"></div>
          <div class="hero-support" id="heroSupport-live">-</div>
        </div>
      </div>
      <div class="hero-metrics">
        <div class="hm-cell"><div class="hm-value green" id="hm-live-0">-</div><div class="hm-label">tokens saved</div></div>
        <div class="hm-arrow">&rarr;</div>
        <div class="hm-cell right"><div class="hm-value green" id="hm-live-1">-</div><div class="hm-label">est. cost saved</div></div>
        <div class="hm-cell"><div class="hm-value cyan" id="hm-live-2">-</div><div class="hm-label">time saved</div></div>
        <div class="hm-arrow">&rarr;</div>
        <div class="hm-cell right"><div class="hm-value blue" id="hm-live-3">-</div><div class="hm-label">+runway gained</div></div>
      </div>
    </div>

    <div class="stats-grid">
      <div class="stat-card cyan" data-tooltip="How much context window you have left. When this gets low, your session is running out of room."><div class="stat-value" id="ls-ctxutil">-</div><div class="stat-label">Context Remaining</div><div class="stat-sub">window left</div></div>
      <div class="stat-card red" data-tooltip="How fast you're consuming context. Higher means you're using runway faster. Based on the last 5 minutes of activity."><div class="stat-value" id="ls-burn">-</div><div class="stat-label">Burn Rate</div><div class="stat-sub">tok/min</div></div>
      <div class="stat-card green" data-tooltip="Percentage of file reads that aOa optimized. Higher means more of Claude's reading is being steered to save tokens."><div class="stat-value" id="ls-guided">-</div><div class="stat-label">Guided Ratio</div><div class="stat-sub">of reads guided</div></div>
      <div class="stat-card blue" data-tooltip="How fast Claude is generating responses. Smoothed over recent turns so it doesn't spike."><div class="stat-value" id="ls-speed">-</div><div class="stat-label">Output Speed</div><div class="stat-sub">tok/sec</div></div>
      <div class="stat-card purple" data-tooltip="Dollars saved because Anthropic's prompt cache served tokens at a fraction of the normal price. Based on published API rates."><div class="stat-value" id="ls-cachesave">-</div><div class="stat-label">Cache Savings</div><div class="stat-sub">from prompt cache</div></div>
      <div class="stat-card yellow" data-tooltip="Progress toward the next learning cycle. Every 50 prompts, aOa recalibrates what it knows about your project."><div class="stat-value" id="ls-autotune">-</div><div class="stat-label">Autotune</div><div class="stat-sub">next cycle</div></div>
    </div>

    <div class="card activity-card">
      <div class="card-header">
        <span class="card-title">Activity &amp; Impact</span>
        <span class="card-badge" id="activityCount">0</span>
      </div>
      <div class="activity-table-wrap">
        <table class="activity-table">
          <thead><tr>
            <th class="col-time">Time</th>
            <th class="col-action">Action</th>
            <th class="col-source">Source</th>
            <th class="col-attrib">Attrib</th>
            <th class="col-impact">Impact</th>
            <th class="col-learned">Learned</th>
            <th class="col-target">Target</th>
          </tr></thead>
          <tbody id="activityTbody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- ════════════════════════════════════════════════════
       RECON TAB (Stub)
       ════════════════════════════════════════════════════ -->
  <div class="tab-content" id="tab-recon">
    <div class="hero-row">
      <div class="hero-card-wrapper">
        <div class="hero-card">
          <div class="hero-label">RECON</div>
          <div class="hero-headline" id="heroHeadline-recon"></div>
          <div class="hero-support" id="heroSupport-recon">Dimensional analysis across security, quality, complexity, and architecture</div>
        </div>
      </div>
      <div class="hero-metrics">
        <div class="hm-cell"><div class="hm-value green" id="hm-recon-0">-</div><div class="hm-label">files scanned</div></div>
        <div class="hm-arrow">&rarr;</div>
        <div class="hm-cell right"><div class="hm-value red" id="hm-recon-1">-</div><div class="hm-label">findings</div></div>
        <div class="hm-cell"><div class="hm-value red" id="hm-recon-2">-</div><div class="hm-label">critical</div></div>
        <div class="hm-arrow">&rarr;</div>
        <div class="hm-cell right"><div class="hm-value green" id="hm-recon-3">-</div><div class="hm-label">clean file %</div></div>
      </div>
    </div>

    <div class="stats-grid" style="grid-template-columns:repeat(5,1fr)">
      <div class="stat-card yellow" data-tooltip="Average number of findings per scanned file. Lower is cleaner. Compare across scans to track improvement."><div class="stat-value" id="rs-density">-</div><div class="stat-label">Findings/File</div><div class="stat-sub">finding density</div></div>
      <div class="stat-card red" data-tooltip="Issues that need immediate attention. These are high-severity findings that could affect security or reliability."><div class="stat-value" id="rs-critical">-</div><div class="stat-label">Critical</div><div class="stat-sub">immediate attention</div></div>
      <div class="stat-card yellow" data-tooltip="Issues worth reviewing when you have time. Not urgent, but cleaning these up improves overall code quality."><div class="stat-value" id="rs-warnings">-</div><div class="stat-label">Warnings</div><div class="stat-sub">should review</div></div>
      <div class="stat-card green" data-tooltip="Percentage of scanned files with zero findings. Higher means a cleaner codebase overall."><div class="stat-value" id="rs-cleanpct">-</div><div class="stat-label">Clean File%</div><div class="stat-sub">no findings</div></div>
      <div class="stat-card purple" data-tooltip="How many analysis dimensions are active. Each dimension scans for a different category of code quality issues."><div class="stat-value" id="rs-dims">-</div><div class="stat-label">Dimensions</div><div class="stat-sub"><span id="rs-active-count">-</span> active</div></div>
    </div>

    <div class="recon-layout">
      <div class="recon-sidebar" id="reconSidebar">
        <div class="recon-sidebar-header">Dimensions</div>
        <div class="recon-sidebar-footer"><span id="rs-sidebar-active">-</span> of <span id="rs-sidebar-total">-</span> active</div>
      </div>
      <div class="recon-main">
        <div class="tree-card">
          <div class="tree-header">
            <span class="tree-title" id="reconBreadcrumb"><span class="bc-link" data-nav="root">Root</span></span>
            <span class="tree-badge" id="reconTreeBadge">-</span>
          </div>
          <div class="tree-wrap" id="reconTreeWrap"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ════════════════════════════════════════════════════
       INTEL TAB
       ════════════════════════════════════════════════════ -->
  <div class="tab-content" id="tab-intel">
    <div class="hero-row">
      <div class="hero-card-wrapper">
        <div class="hero-card">
          <div class="hero-label">INTEL</div>
          <div class="hero-headline" id="heroHeadline-intel"></div>
          <div class="hero-support" id="heroSupport-intel">-</div>
        </div>
      </div>
      <div class="hero-metrics">
        <div class="hm-cell"><div class="hm-value purple" id="hm-intel-0">-</div><div class="hm-label">core domains</div></div>
        <div class="hm-arrow">&rarr;</div>
        <div class="hm-cell right"><div class="hm-value green" id="hm-intel-1">-</div><div class="hm-label">domain velocity</div></div>
        <div class="hm-cell"><div class="hm-value cyan" id="hm-intel-2">-</div><div class="hm-label">term coherence</div></div>
        <div class="hm-arrow">&rarr;</div>
        <div class="hm-cell right"><div class="hm-value yellow" id="hm-intel-3">-</div><div class="hm-label">KW&rarr;domain %</div></div>
      </div>
    </div>

    <div class="stats-grid">
      <div class="stat-card purple" data-tooltip="Total semantic domains aOa has discovered in your project. Each domain represents a category of knowledge like authentication, testing, or API design."><div class="stat-value" id="is-domains">-</div><div class="stat-label">Domains</div><div class="stat-sub">semantic domains</div></div>
      <div class="stat-card green" data-tooltip="Domains promoted to core status through repeated use. These are the areas aOa is most confident about in your project."><div class="stat-value" id="is-core">-</div><div class="stat-label">Core</div><div class="stat-sub">top ranked</div></div>
      <div class="stat-card cyan" data-tooltip="Semantic terms mapped from your code and conversations. Terms bridge raw keywords to meaningful domains."><div class="stat-value" id="is-terms">-</div><div class="stat-label">Terms</div><div class="stat-sub">atlas terms matched</div></div>
      <div class="stat-card blue" data-tooltip="How many new keywords aOa picks up per autotune cycle. Shows learning momentum — higher means the system is actively discovering."><div class="stat-value" id="is-learnrate">-</div><div class="stat-label">Learning Rate</div><div class="stat-sub">keywords/cycle</div></div>
      <div class="stat-card yellow" data-tooltip="Word pairs extracted from your conversations with Claude. These capture how you naturally describe your project."><div class="stat-value" id="is-bigrams">-</div><div class="stat-label">Bigrams</div><div class="stat-sub">conversation patterns</div></div>
      <div class="stat-card red" data-tooltip="Total learning signals received across all domains. Each time aOa observes relevant code activity, it records a hit."><div class="stat-value" id="is-totalhits">-</div><div class="stat-label">Total Hits</div><div class="stat-sub">learning signals</div></div>
    </div>

    <div class="learning-grid">
      <div class="card">
        <div class="card-header">
          <div><span class="card-title">Domain Rankings</span><span style="font-weight:400;color:var(--dim);font-size:12px"> &mdash; sorted by learning signal strength</span></div>
          <span class="card-badge" id="domainCount">0</span>
        </div>
        <div class="domain-table-wrap">
          <table class="domain-table">
            <thead><tr><th>#</th><th>Domain</th><th style="text-align:right">Hits</th><th>Terms</th></tr></thead>
            <tbody id="domainTbody"></tbody>
          </table>
        </div>
        <div class="domain-footer"><span class="aoa-brand">aOa</span> learns your workflow &rarr; Claude reads only what it needs.</div>
      </div>

      <div class="card">
        <div class="card-header">
          <div><span class="card-title">N-gram Metrics</span></div>
          <span class="card-badge" id="ngramCount">0</span>
        </div>
        <div class="ngram-wrap">
          <div class="ngram-section">
            <div class="ngram-section-title">Bigrams <span class="text-cyan">&bull;</span></div>
            <div id="ngramBigrams"></div>
          </div>
          <div class="ngram-section">
            <div class="ngram-section-title">Cohits KW &rarr; Term <span class="text-green">&bull;</span></div>
            <div id="ngramCohitKw"></div>
          </div>
          <div class="ngram-section">
            <div class="ngram-section-title">Cohits Term &rarr; Domain <span class="text-purple">&bull;</span></div>
            <div id="ngramCohitTd"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ════════════════════════════════════════════════════
       DEBRIEF TAB
       ════════════════════════════════════════════════════ -->
  <div class="tab-content" id="tab-debrief">
    <div class="hero-row">
      <div class="hero-card-wrapper">
        <div class="hero-card">
          <div class="hero-label">DEBRIEF</div>
          <div class="hero-headline" id="heroHeadline-debrief"></div>
          <div class="hero-support" id="heroSupport-debrief">-</div>
        </div>
      </div>
      <div class="hero-metrics">
        <div class="hm-cell"><div class="hm-value cyan" id="hm-debrief-0">-</div><div class="hm-label">input tokens</div></div>
        <div class="hm-arrow">&rarr;</div>
        <div class="hm-cell right"><div class="hm-value green" id="hm-debrief-1">-</div><div class="hm-label">output tokens</div></div>
        <div class="hm-cell"><div class="hm-value blue" id="hm-debrief-2">-</div><div class="hm-label">cache savings</div></div>
        <div class="hm-arrow">&rarr;</div>
        <div class="hm-cell right"><div class="hm-value purple" id="hm-debrief-3">-</div><div class="hm-label">cost/turn</div></div>
      </div>
    </div>

    <div class="stats-grid">
      <div class="stat-card blue" data-tooltip="Percentage of input tokens served from Anthropic's prompt cache. Higher means you're paying less per turn because cached tokens cost a fraction of fresh input."><div class="stat-value" id="ds-hitrate">-</div><div class="stat-label">Cache Hit%</div><div class="stat-sub">reuse rate</div></div>
      <div class="stat-card green" data-tooltip="How fast Claude is generating responses in tokens per second. Smoothed over recent turns to reflect consistent performance."><div class="stat-value" id="ds-speed">-</div><div class="stat-label">Output Speed</div><div class="stat-sub">tokens/sec</div></div>
      <div class="stat-card cyan" data-tooltip="Average wall-clock time per turn, from your prompt to Claude's complete response. Includes thinking, tool use, and output."><div class="stat-value" id="ds-turndur">-</div><div class="stat-label">Avg Turn Dur</div><div class="stat-sub">per exchange</div></div>
      <div class="stat-card yellow" data-tooltip="Average number of tool calls per turn. Higher means Claude is doing more work per prompt — reading files, running commands, making edits."><div class="stat-value" id="ds-tooldensity">-</div><div class="stat-label">Tool Density</div><div class="stat-sub">tools/turn</div></div>
      <div class="stat-card purple" data-tooltip="For every character you type, how many characters Claude produces. Shows the leverage you get from each prompt."><div class="stat-value" id="ds-amplify">-</div><div class="stat-label">Amplification</div><div class="stat-sub">output/input ratio</div></div>
      <div class="stat-card red" data-tooltip="Which Claude model handled most of this session. Different models have different costs and capabilities."><div class="stat-value" id="ds-modelmix">-</div><div class="stat-label">Model Mix</div><div class="stat-sub">primary model</div></div>
    </div>

    <div class="conv-grid">
      <div class="card conv-col">
        <div class="card-header">
          <span class="card-title">Conversation Feed</span>
          <span class="card-badge" id="convCount">0</span>
        </div>
        <div class="conv-messages" id="convMessages"></div>
        <button id="nowBtnMsg" class="now-btn" onclick="scrollToNow('convMessages')" style="display:none">Now ↓</button>
      </div>
      <div class="card conv-col">
        <div class="card-header">
          <span class="card-title">Actions</span>
        </div>
        <div class="conv-actions" id="convActions"></div>
        <button id="nowBtnAct" class="now-btn" onclick="scrollToNow('convActions')" style="display:none">Now ↓</button>
      </div>
    </div>
  </div>

  <!-- ════════════════════════════════════════════════════
       ARSENAL TAB
       ════════════════════════════════════════════════════ -->
  <div class="tab-content" id="tab-arsenal">
    <div class="hero-row">
      <div class="hero-card-wrapper">
        <div class="hero-card">
          <div class="hero-label">ARSENAL</div>
          <div class="hero-headline" id="heroHeadline-arsenal"></div>
          <div class="hero-support" id="heroSupport-arsenal">-</div>
        </div>
      </div>
      <div class="hero-metrics">
        <div class="hm-cell"><div class="hm-value green" id="hm-arsenal-0">-</div><div class="hm-label">cost avoidance</div></div>
        <div class="hm-arrow">&rarr;</div>
        <div class="hm-cell right"><div class="hm-value blue" id="hm-arsenal-1">-</div><div class="hm-label">sessions extended</div></div>
        <div class="hm-cell"><div class="hm-value cyan" id="hm-arsenal-2">-</div><div class="hm-label">cache savings</div></div>
        <div class="hm-arrow">&rarr;</div>
        <div class="hm-cell right"><div class="hm-value purple" id="hm-arsenal-3">-</div><div class="hm-label">efficiency</div></div>
      </div>
    </div>

    <div class="stats-grid">
      <div class="stat-card cyan" data-tooltip="Lifetime percentage of file reads that aOa optimized across all sessions. Shows how consistently aOa is steering Claude's reading."><div class="stat-value" id="as-ratio">-</div><div class="stat-label">Guided Ratio</div><div class="stat-sub">overall</div></div>
      <div class="stat-card red" data-tooltip="Tokens consumed by unguided reads — file reads that aOa couldn't optimize. This is what you'd save if every read were guided."><div class="stat-value" id="as-cost">-</div><div class="stat-label">Unguided Cost</div><div class="stat-sub">waste tokens</div></div>
      <div class="stat-card blue" data-tooltip="Total number of Claude Code sessions aOa has tracked. Each session is a separate conversation with its own learning and cost data."><div class="stat-value" id="as-sessions">-</div><div class="stat-label">Sessions</div><div class="stat-sub">tracked</div></div>
      <div class="stat-card purple" data-tooltip="Average number of prompts per session. Shows how deep your typical sessions go — longer sessions benefit more from aOa's learning."><div class="stat-value" id="as-avgprompts">-</div><div class="stat-label">Avg Prompts</div><div class="stat-sub">per session</div></div>
      <div class="stat-card green" data-tooltip="Total tokens saved across all sessions by guiding Claude to read only the relevant parts of files instead of entire files."><div class="stat-value" id="as-saved">-</div><div class="stat-label">Tokens Saved</div><div class="stat-sub">cumulative</div></div>
      <div class="stat-card yellow" data-tooltip="Average number of file reads per prompt across all sessions. Shows how much information Claude needs to gather for each question you ask."><div class="stat-value" id="as-velocity">-</div><div class="stat-label">Read Velocity</div><div class="stat-sub">reads per prompt</div></div>
    </div>

    <!-- Savings Chart -->
    <div class="card">
      <div class="card-header">
        <span class="card-title">Daily Savings</span>
        <span class="card-badge" id="savingsLabel">-</span>
      </div>
      <div class="chart-area" id="savingsChartArea"></div>
      <div class="chart-legend">
        <span><span class="chart-legend-dot green"></span>Actual</span>
        <span><span class="chart-legend-dot red"></span>Counterfactual (without aOa)</span>
      </div>
    </div>

    <!-- Bottom split: Session table + Learning curve + System status -->
    <div class="arsenal-bottom">
      <div class="card">
        <div class="card-header">
          <span class="card-title">Session History</span>
          <span class="card-badge" id="sessionCount">0</span>
        </div>
        <div class="domain-table-wrap">
          <table class="session-table">
            <thead><tr>
              <th>ID</th><th>Date</th><th>Dur</th><th>P</th><th>R</th><th>Guided</th><th>Saved</th><th>Time</th><th>Waste</th><th>R/P</th>
            </tr></thead>
            <tbody id="sessionTbody"></tbody>
          </table>
        </div>
      </div>
      <div style="display:flex;flex-direction:column;gap:16px;min-height:0">
        <div class="card" style="flex:0 0 auto">
          <div class="card-header">
            <span class="card-title">Learning Curve</span>
          </div>
          <div class="curve-canvas-wrap">
            <canvas id="learningCurveCanvas" height="120"></canvas>
          </div>
        </div>
        <div class="card" style="flex:0 0 auto">
          <div class="card-header">
            <span class="card-title">System Status</span>
          </div>
          <div class="sys-strip">
            <div class="sys-pair"><span class="sys-key">PID</span><span class="sys-val" id="sys-pid">-</span></div>
            <div class="sys-pair"><span class="sys-key">Uptime</span><span class="sys-val" id="sys-uptime">-</span></div>
            <div class="sys-pair"><span class="sys-key">DB</span><span class="sys-val" id="sys-db">-</span></div>
            <div class="sys-pair"><span class="sys-key">Files</span><span class="sys-val" id="sys-files">-</span></div>
            <div class="sys-pair"><span class="sys-key">Tokens</span><span class="sys-val" id="sys-tokens">-</span></div>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>

<!-- ══════ FOOTER ══════ -->
<footer class="footer">
  <div class="footer-left">
    <span class="footer-online"><span class="dot"></span> <span id="footerStatus">Online</span></span>
    <span>v1.0.0</span>
  </div>
  <div class="footer-right">
    <span class="footer-motto"><span class="aoa-brand">aOa</span> learns &rarr; you build faster. <span class="way">This is the way.</span></span>
    <span class="footer-clock" id="clock">00:00:00</span>
  </div>
</footer>

<script src="app.js"></script>
</body>
</html>
